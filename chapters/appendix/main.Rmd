---
output:
  pdf_document: default
fontsize: 12pt
geometry: margin=1in
documentclass: book
header-includes:
  \setlength{\parskip}{1em}
---

```{r setup, include=FALSE, warning=F}
knitr::opts_chunk$set(echo = F, warning=F, comment = NA)
```

```{r include = FALSE}
rm(list=ls())
library(readxl)
library(dplyr)
library(ggplot2)
library(rstatix)
library(BSDA)
library(gridExtra)
library(kableExtra)
library(lawstat)

require(pander)
panderOptions('round', 2)


##### SET UP DATA #####
for(i in 1:6){
    r <- assign(paste0("r",i), (as.data.frame(read_excel("C:/Users/Katie/OneDrive/Uni_Work_Year4/Project/Year-4-Project/survey responses/raw.xlsx", paste0("R - v",i)))))
    py <- assign(paste0("py",i), (as.data.frame(read_excel("C:/Users/Katie/OneDrive/Uni_Work_Year4/Project/Year-4-Project/survey responses/raw.xlsx", paste0("Py - v",i)))))
    assign(paste0("ver",i), rbind(r, py))
}

ver1 <- ver1[-1,]
r1 <- r1[-1,]
py1 <- py1[-1,]

names(ver1) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "con_1", "con_2", "con_3", "con_4", 
                 "log_1", "log_2", "log_3", "log_4",
                 "trn_1", "trn_2", "trn_3", "trn_4",
  
                 "def_1", "def_2", "def_3", 
                 "nar_1", "nar_2", "nar_3", 
                 "wid_1", "wid_2", "wid_3",
                 "all_1", "all_2", "all_3",
  
                 "vir_sta_1", "vir_sta_2", "vir_sta_3", "vir_sta_4", 
                 "vir_grp_1", "vir_grp_2", "vir_grp_3", "vir_grp_4",
                 "sta_dge",
                 "a_cols_1", "a_cols_2", 
  
                 "sep_1a", "sep_1b", "sep_2",
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
  
                 "cd_trn",
                 "cd_zro"
                 )

names(r1) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "con_1", "con_2", "con_3", "con_4", 
                 "log_1", "log_2", "log_3", "log_4",
                 "trn_1", "trn_2", "trn_3", "trn_4",
  
                 "def_1", "def_2", "def_3", 
                 "nar_1", "nar_2", "nar_3", 
                 "wid_1", "wid_2", "wid_3",
                 "all_1", "all_2", "all_3",
  
                 "vir_sta_1", "vir_sta_2", "vir_sta_3", "vir_sta_4", 
                 "vir_grp_1", "vir_grp_2", "vir_grp_3", "vir_grp_4",
                 "sta_dge",
                 "a_cols_1", "a_cols_2", 
  
                 "sep_1a", "sep_1b", "sep_2",
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
  
                 "cd_trn",
                 "cd_zro"
                 )

names(py1) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "con_1", "con_2", "con_3", "con_4", 
                 "log_1", "log_2", "log_3", "log_4",
                 "trn_1", "trn_2", "trn_3", "trn_4",
  
                 "def_1", "def_2", "def_3", 
                 "nar_1", "nar_2", "nar_3", 
                 "wid_1", "wid_2", "wid_3",
                 "all_1", "all_2", "all_3",
  
                 "vir_sta_1", "vir_sta_2", "vir_sta_3", "vir_sta_4", 
                 "vir_grp_1", "vir_grp_2", "vir_grp_3", "vir_grp_4",
                 "sta_dge",
                 "a_cols_1", "a_cols_2", 
  
                 "sep_1a", "sep_1b", "sep_2",
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
  
                 "cd_trn",
                 "cd_zro")


names(ver2) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "con_1", "con_2", "con_3", "con_4", 
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 "log_1", "log_2", "log_3", "log_4",
                 
                 "def_1", "def_2", "def_3", 
                 "wid_1", "wid_2", "wid_3",
                 "nar_1", "nar_2", "nar_3", 
                 "all_1", "all_2", "all_3",
                 
                 "def_sta_1", "def_sta_2", "def_sta_3", "def_sta_4", 
                 "def_grp_1", "def_grp_2", "def_grp_3", "def_grp_4",
                 "sta_dge",
                 "b_cols_1", "b_cols_2", 
  
                 "sep_1a", "sep_1b", "sep_2",
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
  
                 "cd_trn",
                 "cd_zro"
                 )

names(r2) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "con_1", "con_2", "con_3", "con_4", 
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 "log_1", "log_2", "log_3", "log_4",
                 
                 "def_1", "def_2", "def_3", 
                 "wid_1", "wid_2", "wid_3",
                 "nar_1", "nar_2", "nar_3", 
                 "all_1", "all_2", "all_3",
                 
                 "def_sta_1", "def_sta_2", "def_sta_3", "def_sta_4", 
                 "def_grp_1", "def_grp_2", "def_grp_3", "def_grp_4",
                 "sta_dge",
                 "b_cols_1", "b_cols_2", 
  
                 "sep_1a", "sep_1b", "sep_2",
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
  
                 "cd_trn",
                 "cd_zro"
                 )

names(py2) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "con_1", "con_2", "con_3", "con_4", 
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 "log_1", "log_2", "log_3", "log_4",
                 
                 "def_1", "def_2", "def_3", 
                 "wid_1", "wid_2", "wid_3",
                 "nar_1", "nar_2", "nar_3", 
                 "all_1", "all_2", "all_3",
                 
                 "def_sta_1", "def_sta_2", "def_sta_3", "def_sta_4", 
                 "def_grp_1", "def_grp_2", "def_grp_3", "def_grp_4",
                 "sta_dge",
                 "b_cols_1", "b_cols_2", 
  
                 "sep_1a", "sep_1b", "sep_2",
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
  
                 "cd_trn",
                 "cd_zro"
                 )


names(ver3) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "log_1", "log_2", "log_3", "log_4",
                 "con_1", "con_2", "con_3", "con_4", 
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 
                 "nar_1", "nar_2", "nar_3", 
                 "def_1", "def_2", "def_3", 
                 "wid_1", "wid_2", "wid_3",  
                 "all_1", "all_2", "all_3",
                 
                 "def_grp_1", "def_grp_2", "def_grp_3", "def_grp_4",
                 "def_sta_1", "def_sta_2", "def_sta_3", "def_sta_4", 
                 "sta_dge",
                 "c_cols_1", "c_cols_2", 
  
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 "sep_1a", "sep_1b", "sep_2",
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",                
  
                 "cd_zro",
                 "cd_trn"
                 )

names(r3) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "log_1", "log_2", "log_3", "log_4",
                 "con_1", "con_2", "con_3", "con_4", 
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 
                 "nar_1", "nar_2", "nar_3", 
                 "def_1", "def_2", "def_3", 
                 "wid_1", "wid_2", "wid_3",  
                 "all_1", "all_2", "all_3",
                 
                 "def_grp_1", "def_grp_2", "def_grp_3", "def_grp_4",
                 "def_sta_1", "def_sta_2", "def_sta_3", "def_sta_4", 
                 "sta_dge",
                 "c_cols_1", "c_cols_2", 
  
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 "sep_1a", "sep_1b", "sep_2",
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",                
  
                 "cd_zro",
                 "cd_trn"
                 )

names(py3) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "log_1", "log_2", "log_3", "log_4",
                 "con_1", "con_2", "con_3", "con_4", 
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 
                 "nar_1", "nar_2", "nar_3", 
                 "def_1", "def_2", "def_3", 
                 "wid_1", "wid_2", "wid_3",  
                 "all_1", "all_2", "all_3",
                 
                 "def_grp_1", "def_grp_2", "def_grp_3", "def_grp_4",
                 "def_sta_1", "def_sta_2", "def_sta_3", "def_sta_4", 
                 "sta_dge",
                 "c_cols_1", "c_cols_2", 
  
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 "sep_1a", "sep_1b", "sep_2",
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",                
  
                 "cd_zro",
                 "cd_trn"
                 )


names(ver4) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "log_1", "log_2", "log_3", "log_4",
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 "con_1", "con_2", "con_3", "con_4", 
  
                 "nar_1", "nar_2", "nar_3", 
                 "wid_1", "wid_2", "wid_3",
                 "def_1", "def_2", "def_3", 
                 "all_1", "all_2", "all_3",
  
                 "gr_sta_1", "gr_sta_2", "gr_sta_3", "gr_sta_4",
                 "gr_grp_1", "gr_grp_2", "gr_grp_3", "gr_grp_4",  
                 "sta_dge",
                 "d_cols_1", "d_cols_2", 
  
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
                 "sep_1a", "sep_1b", "sep_2",

                 "cd_trn",
                 "cd_zro"
                 )

names(r4) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "log_1", "log_2", "log_3", "log_4",
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 "con_1", "con_2", "con_3", "con_4", 
  
                 "nar_1", "nar_2", "nar_3", 
                 "wid_1", "wid_2", "wid_3",
                 "def_1", "def_2", "def_3", 
                 "all_1", "all_2", "all_3",
  
                 "gr_sta_1", "gr_sta_2", "gr_sta_3", "gr_sta_4",
                 "gr_grp_1", "gr_grp_2", "gr_grp_3", "gr_grp_4",  
                 "sta_dge",
                 "d_cols_1", "d_cols_2", 
  
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
                 "sep_1a", "sep_1b", "sep_2",

                 "cd_trn",
                 "cd_zro"
                 )

names(py4) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "log_1", "log_2", "log_3", "log_4",
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 "con_1", "con_2", "con_3", "con_4", 
  
                 "nar_1", "nar_2", "nar_3", 
                 "wid_1", "wid_2", "wid_3",
                 "def_1", "def_2", "def_3", 
                 "all_1", "all_2", "all_3",
  
                 "gr_sta_1", "gr_sta_2", "gr_sta_3", "gr_sta_4",
                 "gr_grp_1", "gr_grp_2", "gr_grp_3", "gr_grp_4",  
                 "sta_dge",
                 "d_cols_1", "d_cols_2", 
  
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
                 "sep_1a", "sep_1b", "sep_2",

                 "cd_trn",
                 "cd_zro"
                 )


names(ver5) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 "con_1", "con_2", "con_3", "con_4",
                 "log_1", "log_2", "log_3", "log_4", 
                 
                 "wid_1", "wid_2", "wid_3",
                 "def_1", "def_2", "def_3", 
                 "nar_1", "nar_2", "nar_3", 
                 "all_1", "all_2", "all_3",
  
                 "vir_grp_1", "vir_grp_2", "vir_grp_3", "vir_grp_4",
                 "vir_sta_1", "vir_sta_2", "vir_sta_3", "vir_sta_4", 
                 "sta_dge",
                 "e_cols_1", "e_cols_2", 
  
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
                 "sep_1a", "sep_1b", "sep_2",
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 
                 "cd_zro",
                 "cd_trn"
                 )

names(r5) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 "con_1", "con_2", "con_3", "con_4",
                 "log_1", "log_2", "log_3", "log_4", 
                 
                 "wid_1", "wid_2", "wid_3",
                 "def_1", "def_2", "def_3", 
                 "nar_1", "nar_2", "nar_3", 
                 "all_1", "all_2", "all_3",
  
                 "vir_grp_1", "vir_grp_2", "vir_grp_3", "vir_grp_4",
                 "vir_sta_1", "vir_sta_2", "vir_sta_3", "vir_sta_4", 
                 "sta_dge",
                 "e_cols_1", "e_cols_2", 
  
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
                 "sep_1a", "sep_1b", "sep_2",
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 
                 "cd_zro",
                 "cd_trn"
                 )

names(py5) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 "con_1", "con_2", "con_3", "con_4",
                 "log_1", "log_2", "log_3", "log_4", 
                 
                 "wid_1", "wid_2", "wid_3",
                 "def_1", "def_2", "def_3", 
                 "nar_1", "nar_2", "nar_3", 
                 "all_1", "all_2", "all_3",
  
                 "vir_grp_1", "vir_grp_2", "vir_grp_3", "vir_grp_4",
                 "vir_sta_1", "vir_sta_2", "vir_sta_3", "vir_sta_4", 
                 "sta_dge",
                 "e_cols_1", "e_cols_2", 
  
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
                 "sep_1a", "sep_1b", "sep_2",
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 
                 "cd_zro",
                 "cd_trn"
                 )

names(ver6) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 "log_1", "log_2", "log_3", "log_4", 
                 "con_1", "con_2", "con_3", "con_4",
                 
                 "wid_1", "wid_2", "wid_3",
                 "nar_1", "nar_2", "nar_3", 
                 "def_1", "def_2", "def_3", 
                 "all_1", "all_2", "all_3",
  
                 "gr_grp_1", "gr_grp_2", "gr_grp_3", "gr_grp_4",
                 "gr_sta_1", "gr_sta_2", "gr_sta_3", "gr_sta_4", 
                 "sta_dge",
                 "f_cols_1", "f_cols_2", 
  
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 "sep_1a", "sep_1b", "sep_2",
                 
                 "cd_zro",
                 "cd_trn"
                 )
                 
names(r6) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 "log_1", "log_2", "log_3", "log_4", 
                 "con_1", "con_2", "con_3", "con_4",
                 
                 "wid_1", "wid_2", "wid_3",
                 "nar_1", "nar_2", "nar_3", 
                 "def_1", "def_2", "def_3", 
                 "all_1", "all_2", "all_3",
  
                 "gr_grp_1", "gr_grp_2", "gr_grp_3", "gr_grp_4",
                 "gr_sta_1", "gr_sta_2", "gr_sta_3", "gr_sta_4", 
                 "sta_dge",
                 "f_cols_1", "f_cols_2", 
  
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 "sep_1a", "sep_1b", "sep_2",
                 
                 "cd_zro",
                 "cd_trn"
                 )

names(py6) <- c("timestamp", "consent", "age", "uni", "sp_aware", "obs_skl", "num_skl", "cblind", "vis_pro",
                 
                 "trn_1", "trn_2", "trn_3", "trn_4",
                 "log_1", "log_2", "log_3", "log_4", 
                 "con_1", "con_2", "con_3", "con_4",
                 
                 "wid_1", "wid_2", "wid_3",
                 "nar_1", "nar_2", "nar_3", 
                 "def_1", "def_2", "def_3", 
                 "all_1", "all_2", "all_3",
  
                 "gr_grp_1", "gr_grp_2", "gr_grp_3", "gr_grp_4",
                 "gr_sta_1", "gr_sta_2", "gr_sta_3", "gr_sta_4", 
                 "sta_dge",
                 "f_cols_1", "f_cols_2", 
  
                 "ab_zro_1", "ab_zro_1b", "ab_zro_2",
                 "ab_trn_1a", "ab_trn_1b", "ab_trn_2", 
                 "sep_1a", "sep_1b", "sep_2",
                 
                 "cd_zro",
                 "cd_trn"
                 )
##### Y SCALES #####
ctrl_y_scale <- rbind(ver1[,c(4:7, 10:13)], ver2[,c(4:7, 10:13)], ver3[,c(4:7, 14:17)], ver4[,c(4:7, 18:21)], ver5[,c(4:7, 14:17)], ver6[,c(4:7, 18:21)])
log_y_scale <- rbind(ver1[,c(4:7, 14:17)], ver2[,c(4:7, 18:21)], ver3[,c(4:7, 10:13)], ver4[,c(4:7, 10:13)], ver5[,c(4:7, 18:21)], ver6[,c(4:7, 14:17)])
trnc_y_scale <- rbind(ver1[,c(4:7, 18:21)], ver2[,c(4:7, 14:17)], ver3[,c(4:7, 18:21)], ver4[,c(4:7, 14:17)], ver5[,c(4:7, 10:13)], ver6[,c(4:7, 10:13)])

ctrl_y_scale_r <- rbind(r1[,c(4:7, 10:13)], r2[,c(4:7, 10:13)], r3[,c(4:7, 14:17)], r4[,c(4:7, 18:21)], r5[,c(4:7, 14:17)], r6[,c(4:7, 18:21)])
log_y_scale_r<- rbind(r1[,c(4:7, 14:17)], r2[,c(4:7, 18:21)], r3[,c(4:7, 10:13)], r4[,c(4:7, 10:13)], r5[,c(4:7, 18:21)], r6[,c(4:7, 14:17)])
trnc_y_scale_r <- rbind(r1[,c(4:7, 18:21)], r2[,c(4:7, 14:17)], r3[,c(4:7, 18:21)], r4[,c(4:7, 14:17)], r5[,c(4:7, 10:13)], r6[,c(4:7, 10:13)])

ctrl_y_scale_py <- rbind(py1[,c(4:7, 10:13)], py2[,c(4:7, 10:13)], py3[,c(4:7, 14:17)], py4[,c(4:7, 18:21)], py5[,c(4:7, 14:17)], py6[,c(4:7, 18:21)])
log_y_scale_py <- rbind(py1[,c(4:7, 14:17)], py2[,c(4:7, 18:21)], py3[,c(4:7, 10:13)], py4[,c(4:7, 10:13)], py5[,c(4:7, 18:21)], py6[,c(4:7, 14:17)])
trnc_y_scale_py <- rbind(py1[,c(4:7, 18:21)], py2[,c(4:7, 14:17)], py3[,c(4:7, 18:21)], py4[,c(4:7, 14:17)], py5[,c(4:7, 10:13)], py6[,c(4:7, 10:13)])

for(i in c(unique(ctrl_y_scale$uni), unique(trnc_y_scale$uni), unique(log_y_scale$uni))){
  assign(paste0(i, "_ctrl"), ctrl_y_scale[which(ctrl_y_scale$uni==i),])
  assign(paste0(i, "_trnc"), trnc_y_scale[which(trnc_y_scale$uni==i),])
  assign(paste0(i, "_log"), log_y_scale[which(log_y_scale$uni==i),])
}

Soc_sci_ctrl <- `Social Sciences_ctrl`
Soc_sci_trnc <- `Social Sciences_trnc`
Soc_sci_log <- `Social Sciences_log`

Sus_geog_ctrl <- `Sustainability/geological science_ctrl`
Sus_geog_trnc <- `Sustainability/geological science_trnc`
Sus_geog_log <- `Sustainability/geological science_log`

stem_ctrl <- rbind(Science_ctrl, Technology_ctrl, Engineering_ctrl, Maths_ctrl, Medicine_ctrl, Architecture_ctrl)
socsci_ctrl <- rbind(psychology_ctrl, Soc_sci_ctrl, Sus_geog_ctrl, Criminology)
hum_ctrl <- rbind(Humanities_ctrl, Geography_ctrl)

stem_trnc <- rbind(Science_trnc, Technology_trnc, Engineering_trnc, Maths_trnc, Medicine_trnc, Architecture_trnc)
socsci_trnc <- rbind(psychology_trnc, Soc_sci_trnc, Sus_geog_trnc, Criminology_trnc)
hum_trnc <- rbind(Humanities_trnc, Geography_trnc)

stem_log <- rbind(Science_log, Technology_log, Engineering_log, Maths_log, Medicine_log, Architecture_log)
socsci_log <- rbind(psychology_log, Soc_sci_log, Sus_geog_log, Criminology_log)
hum_log <- rbind(Humanities_log, Geography_log)



##### ASPECT RATIO #####
def_ratio <- rbind(ver1[,c(4:7, 22:24)], ver2[,c(4:7, 22:24)], ver3[,c(4:7, 25:27)], ver4[,c(4:7, 28:30)], ver5[,c(4:7, 25:27)], ver6[,c(4:7, 28:30)])
nar_ratio <- rbind(ver1[,c(4:7, 25:27)], ver2[,c(4:7, 28:30)], ver3[,c(4:7, 22:24)], ver4[,c(4:7, 22:24)], ver5[,c(4:7, 28:30)], ver6[,c(4:7, 25:27)])
wid_ratio <- rbind(ver1[,c(4:7, 28:30)], ver2[,c(4:7, 25:27)], ver3[,c(4:7, 28:30)], ver4[,c(4:7, 25:27)], ver5[,c(4:7, 22:24)], ver6[,c(4:7, 22:24)])

def_ratio_r <- rbind(r1[,c(4:7, 22:24)], r2[,c(4:7, 22:24)], r3[,c(4:7, 25:27)], r4[,c(4:7, 28:30)], r5[,c(4:7, 25:27)], r6[,c(4:7, 28:30)])
nar_ratio_r <- rbind(r1[,c(4:7, 25:27)], r2[,c(4:7, 28:30)], r3[,c(4:7, 22:24)], r4[,c(4:7, 22:24)], r5[,c(4:7, 28:30)], r6[,c(4:7, 25:27)])
wid_ratio_r <- rbind(r1[,c(4:7, 28:30)], r2[,c(4:7, 25:27)], r3[,c(4:7, 28:30)], r4[,c(4:7, 25:27)], r5[,c(4:7, 22:24)], r6[,c(4:7, 22:24)])

def_ratio_py <- rbind(py1[,c(4:7, 22:24)], py2[,c(4:7, 22:24)], py3[,c(4:7, 25:27)], py4[,c(4:7, 28:30)], py5[,c(4:7, 25:27)], py6[,c(4:7, 28:30)])
nar_ratio_py <- rbind(py1[,c(4:7, 25:27)], py2[,c(4:7, 28:30)], py3[,c(4:7, 22:24)], py4[,c(4:7, 22:24)], py5[,c(4:7, 28:30)], py6[,c(4:7, 25:27)])
wid_ratio_py <- rbind(py1[,c(4:7, 28:30)], py2[,c(4:7, 25:27)], py3[,c(4:7, 28:30)], py4[,c(4:7, 25:27)], py5[,c(4:7, 22:24)], py6[,c(4:7, 22:24)])


for(i in 1:dim(ver1)[1]){
  if(ver1$all_1[i]=="A"){
    ver1$all_1[i] <- "Default"
  }
  if(ver1$all_1[i]=="B"){
    ver1$all_1[i] <- "Narrower"
  }
  if(ver1$all_1[i]=="C"){
    ver1$all_1[i] <- "Wider"
  }
  
  if(ver1$all_2[i]=="A"){
    ver1$all_2[i] <- "Default"
  }
  if(ver1$all_2[i]=="B"){
    ver1$all_2[i] <- "Narrower"
  }
  if(ver1$all_2[i]=="C"){
    ver1$all_2[i] <- "Wider"
  }
  
  if(ver1$all_3[i]=="A"){
    ver1$all_3[i] <- "Default"
  }
  if(ver1$all_3[i]=="B"){
    ver1$all_3[i] <- "Narrower"
  }
  if(ver1$all_3[i]=="C"){
    ver1$all_3[i] <- "Wider"
  }
}

for(i in 1:dim(ver2)[1]){
  if(ver2$all_1[i]=="A"){
    ver2$all_1[i] <- "Default"
  }
  if(ver2$all_1[i]=="C"){
    ver2$all_1[i] <- "Narrower"
  }
  if(ver2$all_1[i]=="B"){
    ver2$all_1[i] <- "Wider"
  }
  
  if(ver2$all_2[i]=="A"){
    ver2$all_2[i] <- "Default"
  }
  if(ver2$all_2[i]=="C"){
    ver2$all_2[i] <- "Narrower"
  }
  if(ver2$all_2[i]=="B"){
    ver2$all_2[i] <- "Wider"
  }
  
  if(ver2$all_3[i]=="A"){
    ver2$all_3[i] <- "Default"
  }
  if(ver2$all_3[i]=="C"){
    ver2$all_3[i] <- "Narrower"
  }
  if(ver2$all_3[i]=="B"){
    ver2$all_3[i] <- "Wider"
  }
}

for(i in 1:dim(ver3)[1]){
  if(ver3$all_1[i]=="B"){
    ver3$all_1[i] <- "Default"
  }
  if(ver3$all_1[i]=="A"){
    ver3$all_1[i] <- "Narrower"
  }
  if(ver3$all_1[i]=="C"){
    ver3$all_1[i] <- "Wider"
  }
  
  if(ver3$all_2[i]=="B"){
    ver3$all_2[i] <- "Default"
  }
  if(ver3$all_2[i]=="A"){
    ver3$all_2[i] <- "Narrower"
  }
  if(ver3$all_2[i]=="C"){
    ver3$all_2[i] <- "Wider"
  }
  
  if(ver3$all_3[i]=="B"){
    ver3$all_3[i] <- "Default"
  }
  if(ver3$all_3[i]=="A"){
    ver3$all_3[i] <- "Narrower"
  }
  if(ver3$all_3[i]=="C"){
    ver3$all_3[i] <- "Wider"
  }
}

for(i in 1:dim(ver4)[1]){
  if(ver4$all_1[i]=="B"){
    ver4$all_1[i] <- "Default"
  }
  if(ver4$all_1[i]=="C"){
    ver4$all_1[i] <- "Narrower"
  }
  if(ver4$all_1[i]=="A"){
    ver4$all_1[i] <- "Wider"
  }
  
  if(ver4$all_2[i]=="B"){
    ver4$all_2[i] <- "Default"
  }
  if(ver4$all_2[i]=="C"){
    ver4$all_2[i] <- "Narrower"
  }
  if(ver4$all_2[i]=="A"){
    ver4$all_2[i] <- "Wider"
  }
  
  if(ver4$all_3[i]=="B"){
    ver4$all_3[i] <- "Default"
  }
  if(ver4$all_3[i]=="C"){
    ver4$all_3[i] <- "Narrower"
  }
  if(ver4$all_3[i]=="A"){
    ver4$all_3[i] <- "Wider"
  }
}

ver5$all_1[is.na(ver5$all_1)] <- "none"

for(i in 1:dim(ver5)[1]){
  
  if(ver5$all_1[i]=="C"){
    ver5$all_1[i] <- "Default"
  }
  if(ver5$all_1[i]=="A"){
    ver5$all_1[i] <- "Narrower"
  }
  if(ver5$all_1[i]=="B"){
    ver5$all_1[i] <- "Wider"
  }
  
  if(ver5$all_2[i]=="C"){
    ver5$all_2[i] <- "Default"
  }
  if(ver5$all_2[i]=="A"){
    ver5$all_2[i] <- "Narrower"
  }
  if(ver5$all_2[i]=="B"){
    ver5$all_2[i] <- "Wider"
  }
  
  if(ver5$all_3[i]=="C"){
    ver5$all_3[i] <- "Default"
  }
  if(ver5$all_3[i]=="A"){
    ver5$all_3[i] <- "Narrower"
  }
  if(ver5$all_3[i]=="B"){
    ver5$all_3[i] <- "Wider"
  }
}

for(i in 1:dim(ver6)[1]){
  if(ver6$all_1[i]=="C"){
    ver6$all_1[i] <- "Default"
  }
  if(ver6$all_1[i]=="B"){
    ver6$all_1[i] <- "Narrower"
  }
  if(ver6$all_1[i]=="A"){
    ver6$all_1[i] <- "Wider"
  }
  
  if(ver6$all_2[i]=="C"){
    ver6$all_2[i] <- "Default"
  }
  if(ver6$all_2[i]=="B"){
    ver6$all_2[i] <- "Narrower"
  }
  if(ver6$all_2[i]=="A"){
    ver6$all_2[i] <- "Wider"
  }
  
  if(ver6$all_3[i]=="C"){
    ver6$all_3[i] <- "Default"
  }
  if(ver6$all_3[i]=="B"){
    ver6$all_3[i] <- "Narrower"
  }
  if(ver6$all_3[i]=="A"){
    ver6$all_3[i] <- "Wider"
  }
}

comp_ratio_all <- rbind(ver1[,c(4:7, 31:33)], ver2[,c(4:7, 31:33)], ver3[,c(4:7, 31:33)], ver4[,c(4:7, 31:33)], ver5[,c(4:7, 31:33)], ver6[,c(4:7, 31:33)])


##### STACKED #####
vir_stacked <- rbind(ver1[,c(4:7, 34:41)], ver5[,c(4:7, 34:41)])
def_stacked <- rbind(ver2[,c(4:7, 34:41)], ver3[,c(4:7, 34:41)])
gr_stacked <- rbind(ver4[,c(4:7, 34:41)], ver6[,c(4:7, 34:41)])

set_a <- ver1[,c(4:9, 42:44)]
set_b <- ver2[,c(4:9, 42:44)]
set_c <- ver3[,c(4:9, 42:44)]
set_d <- ver4[,c(4:9, 42:44)]
set_e <- ver5[,c(4:9, 42:44)]
set_f <- ver6[,c(4:9, 42:44)]

##### SALES_AB #####
ab_sep <- rbind(ver1[,c(4:7, 45:47)], ver2[,c(4:7, 45:47)], ver3[,c(4:7, 48:50)], ver4[,c(4:7, 51:53)], ver5[,c(4:7, 48:50)], ver6[,c(4:7, 51:53)])

ab_trn <- rbind(ver1[,c(4:7, 48:50)], ver2[,c(4:7, 51:53)], ver3[,c(4:7, 45:47)], ver4[,c(4:7, 45:47)], ver5[,c(4:7, 51:53)], ver6[,c(4:7, 48:50)])

ab_zero <- rbind(ver1[,c(4:7, 51:53)], ver2[,c(4:7, 48:50)], ver3[,c(4:7, 51:53)], ver4[,c(4:7, 48:50)], ver5[,c(4:7, 45:47)], ver6[,c(4:7, 45:47)])


##### SALES_CD #####
cd_trn <- rbind(ver1[,c(4:7, 54)], ver2[,c(4:7, 54)], ver3[,c(4:7, 55)], ver4[,c(4:7, 54)], ver5[,c(4:7, 55)], ver6[,c(4:7, 55)])

cd_zro <- rbind(ver1[,c(4:7, 55)], ver2[,c(4:7, 55)], ver3[,c(4:7, 54)], ver4[,c(4:7, 55)], ver5[,c(4:7, 54)], ver6[,c(4:7, 54)])



```


\subsection{Ninja Warrior - Part 1}




\vspace{5cm}

**Approximately many times would you say the 'Salmon Ladder' was used?**

```{r echo=F}
control_1 <- ctrl_y_scale$con_1
control_1 <- control_1[which(control_1 == "41/42")] 
control_1 <- na.exclude(as.numeric(control_1))

control_1_r <- ctrl_y_scale$con_1_r
control_1_r <- control_1_r[which(control_1_r == "41/42")] 
control_1_r <- na.exclude(as.numeric(control_1_r))

control_1_py <- ctrl_y_scale$con_1_py
control_1_py <- control_1_py[which(control_1_py == "41/42")]
control_1_py <- na.exclude(as.numeric(control_1_py))


degsum <- cbind(summary(as.numeric(stem$con_1)), summary(as.numeric(socsci$con_1)), summary(as.numeric(hum$con_1)), summary(as.numeric(Arts$con_1)), summary(as.numeric(Business$con_1)))
colnames(sum) <- c("STEM", "Social Sci", "Humanities", "Arts", "Business")
sum
```



```{r}
truncated_1 <- as.numeric(trnc_y_scale$trn_1)
truncated_1_r<- as.numeric(trnc_y_scale_r$trn_1)
truncated_1_py <- as.numeric(trnc_y_scale_py$trn_1)

degsum <- cbind(summary(as.numeric(stem$con_1)), summary(as.numeric(socsci$con_1)), summary(as.numeric(hum$con_1)), summary(as.numeric(Arts$con_1)), summary(as.numeric(Business$con_1)))
colnames(sum) <- c("STEM", "Social Sci", "Humanities", "Arts", "Business")
sum
```

```{r}
logarithmic_1 <- log_y_scale$log_1
logarithmic_1[which(logarithmic == "Don't know")] <- NA
logarithmic_1[which(logarithmic == "Next to none.")] <- NA
logarithmic_1[which(logarithmic == "10^15")] <- 1e+15
logarithmic_1[which(logarithmic == "10^9")] <- 1e+9
logarithmic_1 <- as.numeric(na.exclude(logarithmic))
```

```{r}
y_scale_1_all <- cbind(control, truncated, logarithmic)
```


```{r echo=F}
truncated_1_r <- as.numeric(trnc_y_scale$trn_1)

logarithmic_1_r <- log_y_scale$log_1
logarithmic_1_r[which(logarithmic == "Don't know")] <- NA
logarithmic_1_r[which(logarithmic == "Next to none.")] <- NA
logarithmic_1_r[which(logarithmic == "10^15")] <- 1e+15
logarithmic_1_r[which(logarithmic == "10^9")] <- 1e+9
logarithmic_1_r <- as.numeric(na.exclude(logarithmic))

y_scale_1_r <- cbind(control, truncated, logarithmic)
```


```{r echo=F}
noquote(paste('n (control) =', length(na.exclude(control))))
noquote(paste('n (truncated) =', length(na.exclude(truncated))))
noquote(paste('n (logarithmic) =', length(na.exclude(logarithmic))))
noquote(rbind(summary(y_scale_1_all), c(paste0('Var    :', round(var(control), 3)), paste0('Var    :', round(var(truncated), 3)), paste0('Var    :', round(var(logarithmic, na.rm=T), 3)))))

```

```{r include=F}
var(truncated)
var(logarithmic)
```


\textbf{Truncated Plot}
```{r echo=F}
shapiro.test(truncated)
```


\textbf{Control Plot}
```{r}
control <- na.exclude(control)
noquote(paste("Median:", median(control)))
noquote(paste("Number of observations below median:", length(control[which(control < median(control))])))
noquote(paste("Number of observations above median:", length(control[which(control > median(control))])))
noquote(paste("Number of observations at median:", length(control[which(control == median(control))])))
```

\textbf{Two sided sign tests for the control plot responses}
```{r echo=F}
noquote(paste("*CONTROL*"))
SIGN.test(control, md=41, alternative="t")
```

\textbf{Truncated Plot}
```{r}
noquote(paste("Median:", median(truncated)))
noquote(paste("Number of observations below median:", length(truncated[which(truncated < median(truncated))])))
noquote(paste("Number of observations above median:", length(truncated[which(truncated > median(truncated))])))
noquote(paste("Number of observations at median:", length(truncated[which(truncated == median(truncated))])))
```

\textbf{Two sided sign tests for the truncated plot responses}
```{r}
noquote(paste("*TRUNCATED*"))
SIGN.test(truncated, md=41, alternative="t")
```


```{r}
noquote(paste("*CONTROL*"))
means <- rep(NA, 100)
for(i in 1:100){
  samp <- rnorm(100, mean=mean(control), sd=sd(control))
  means[i] <- mean(samp)
}
t.test(means, mu=41)

noquote(paste("*TRUNCATED*"))
means <- rep(NA, 100)
for(i in 1:100){
  samp <- rnorm(100, mean=mean(truncated), sd=sd(truncated))
  means[i] <- mean(samp)
}
t.test(means, mu=41)

```


```{r}
logarithmic <- log_y_scale$log_1
logarithmic[which(logarithmic == "Don't know")] <- NA
logarithmic[which(logarithmic == "Next to none.")] <- NA
logarithmic[which(logarithmic == "10^15")] <- NA
logarithmic[which(logarithmic == "10^9")] <-NA
logarithmic <- as.numeric(logarithmic)
noquote(paste('n = ', length(na.exclude(logarithmic))))
summary(na.exclude(logarithmic))
noquote(paste('Var =',var(logarithmic, na.rm=T)))
```


```{r echo=F}

logarithmic <- log_y_scale$log_1
logarithmic[which(logarithmic == "Don't know")] <- NA
logarithmic[which(logarithmic == "Next to none.")] <- NA
logarithmic[which(logarithmic == "10^15")] <- 10e+15
logarithmic[which(logarithmic == "10^9")] <- 10e+9
logarithmic <- as.numeric(logarithmic)

```


```{r echo=F}

logarithmic <- log_y_scale$log_1
logarithmic[which(logarithmic == "Don't know")] <- NA
logarithmic[which(logarithmic == "Next to none.")] <- NA
logarithmic[which(logarithmic == "10^15")] <- NA
logarithmic[which(logarithmic == "10^9")] <- NA
logarithmic[which(logarithmic == "1000.0")] <- NA
logarithmic[which(logarithmic == "1000")] <- NA
logarithmic <- as.numeric(logarithmic)
```


\textbf{Summary statistics of the R versions}
```{r echo=F}

ctrl_y_scale_r <- rbind(r1[,c(4:7, 10:13)], r2[,c(4:7, 10:13)], r3[,c(4:7, 14:17)], r4[,c(4:7, 18:21)], r5[,c(4:7, 14:17)], r6[,c(4:7, 18:21)])
log_y_scale_r <- rbind(r1[,c(4:7, 14:17)], r2[,c(4:7, 18:21)], r3[,c(4:7, 10:13)], r4[,c(4:7, 10:13)], r5[,c(4:7, 18:21)], r6[,c(4:7, 14:17)])
trnc_y_scale_r <- rbind(r1[,c(4:7, 18:21)], r2[,c(4:7, 14:17)], r3[,c(4:7, 18:21)], r4[,c(4:7, 14:17)], r5[,c(4:7, 10:13)], r6[,c(4:7, 10:13)])

r_control <- ctrl_y_scale_r$con_1
r_control[15] <- 41.5 # take midpoint of two values
r_control <- as.numeric(r_control)

r_truncated <- as.numeric(trnc_y_scale_r$trn_1)

r_logarithmic <- log_y_scale_r$log_1

y_scale_r <- cbind(r_control, r_truncated, r_logarithmic)

noquote(paste("n = ", length(r_control)))
summary(y_scale_r)

```


```{r fig.height= 4, fig.width=9}
control <- ctrl_y_scale$con_1
control[which(control == "41/42")] <- 41.5 # take midpoint of two values
control <- as.numeric(control)
 
truncated <- as.numeric(trnc_y_scale$trn_1)

```



```{r fig.height= 4, fig.width=9}

logarithmic <- log_y_scale$log_1
logarithmic[which(logarithmic == "Don't know")] <- NA
logarithmic[which(logarithmic == "Next to none.")] <- NA
logarithmic[which(logarithmic == "10^15")] <- NA
logarithmic[which(logarithmic == "10^9")] <- NA
logarithmic[which(logarithmic == "1000.0")] <- NA
logarithmic[which(logarithmic == "1000")] <- NA
logarithmic <- as.numeric(logarithmic)

```

\textbf{Summary statistics of the Python versions}
```{r echo=F}

ctrl_y_scale_py <- rbind(py1[,c(4:7, 10:13)], py2[,c(4:7, 10:13)], py3[,c(4:7, 14:17)], py4[,c(4:7, 18:21)], py5[,c(4:7, 14:17)], py6[,c(4:7, 18:21)])
log_y_scale_py <- rbind(py1[,c(4:7, 14:17)], py2[,c(4:7, 18:21)], py3[,c(4:7, 10:13)], py4[,c(4:7, 10:13)], py5[,c(4:7, 18:21)], py6[,c(4:7, 14:17)])
trnc_y_scale_py <- rbind(py1[,c(4:7, 18:21)], py2[,c(4:7, 14:17)], py3[,c(4:7, 18:21)], py4[,c(4:7, 14:17)], py5[,c(4:7, 10:13)], py6[,c(4:7, 10:13)])

py_control <- ctrl_y_scale_py$con_1

py_truncated <- as.numeric(trnc_y_scale_py$trn_1)

py_logarithmic <- log_y_scale_py$log_1
py_logarithmic[which(py_logarithmic == "Don't know")] <- NA
py_logarithmic[which(py_logarithmic == "Next to none.")] <- NA
py_logarithmic[which(py_logarithmic == "10^15")] <- 1e+15
py_logarithmic[which(py_logarithmic == "10^9")] <- 1e+9
py_logarithmic <- na.exclude(as.numeric(py_logarithmic))


y_scale_py <- cbind(py_control, py_truncated, py_logarithmic)
noquote(paste('n (control) = ', length(py_control)))
noquote(paste('n (truncated) = ', length(py_truncated)))
noquote(paste('n (logarithmic) = ', length(py_logarithmic)))
summary(y_scale_py)

```




```{r echo=F}

py_logarithmic <- log_y_scale_py$log_1
py_logarithmic[which(py_logarithmic == "Don't know")] <- NA
py_logarithmic[which(py_logarithmic == "Next to none.")] <- NA
py_logarithmic[which(py_logarithmic == "10^15")] <- NA
py_logarithmic[which(py_logarithmic == "10^9")] <- NA
py_logarithmic[which(py_logarithmic == "1000")] <- NA
py_logarithmic[which(py_logarithmic == "1000.0")] <- NA

py_logarithmic <- as.numeric(py_logarithmic)



```

**Approximately how much more than 'Log Grip' would you say 'Salmon Ladder' was was used?**


```{r echo=F}

control <- ctrl_y_scale$con_2
truncated <- trnc_y_scale$trn_2
logarithmic <- log_y_scale$log_2

y_scale_2_all <- cbind(control, truncated, logarithmic)


```

```{r echo=F}
noquote(paste('n (control) = ', length(control)))
noquote(paste('n (truncated) = ', length(truncated)))
noquote(paste('n (logarithmic) = ', length(logarithmic)))
noquote(rbind(summary(y_scale_2_all), c(paste0('Var    :', round(var(control), 3)), paste0('Var    :', round(var(truncated), 3)), paste0('Var    :', round(var(logarithmic), 3)))))

```

```{r echo=F}
y_scale_2_all <- as.data.frame(y_scale_2_all)
resp <- c(control, truncated, logarithmic)
type <- c(rep('Control', 70), rep('Truncated', 70), rep('Logarithmic', 70)) 
stats_2 <- data.frame(resp, type)

```


```{r}
control_r <- ctrl_y_scale_r$con_2
truncated_r <- trnc_y_scale_r$trn_2
logarithmic_r <- log_y_scale_r$log_2

y_scale_2_r <- cbind(control_r, truncated_r, logarithmic_r)


noquote(paste('n (control) = ', length(control_r)))
noquote(paste('n (truncated) = ', length(truncated_r)))
noquote(paste('n (logarithmic) = ', length(logarithmic_r)))

noquote(rbind(summary(y_scale_2_r), c(paste0('Var    :', round(var(control_r), 3)), paste0('Var    :', round(var(truncated_r), 3)), paste0('Var    :', round(var(logarithmic_r), 3)))))

```





```{r}
control_py <- ctrl_y_scale_py$con_2
truncated_py <- trnc_y_scale_py$trn_2
logarithmic_py <- log_y_scale_py$log_2

y_scale_2_py <- cbind(control_py, truncated_py, logarithmic_py)

noquote(paste('n (control) = ', length(control_py)))
noquote(paste('n (truncated) = ', length(truncated_py)))
noquote(paste('n (logarithmic) = ', length(logarithmic_py)))

noquote(rbind(summary(y_scale_2_py), c(paste0('Var    :', round(var(control_py), 3)), paste0('Var    :', round(var(truncated_py), 3)), paste0('Var    :', round(var(logarithmic_py), 3)))))


```

```{r echo=F}
y_scale_2_py <- as.data.frame(y_scale_2_py)
resp <- c(control_py, truncated_py, logarithmic_py)
type <- c(rep('Control', 31), rep('Truncated', 31), rep('Logarithmic', 31)) 
stats_2 <- data.frame(resp, type)


```

**Approximately how much more than 'Quintuple Steps' would you say 'Salmon Ladder' was used?**


```{r echo=F}
control <- ctrl_y_scale$con_3
truncated <- trnc_y_scale$trn_3
logarithmic <- log_y_scale$log_3

y_scale_3_all <- cbind(control, logarithmic, truncated)

```

```{r, echo=F}
summary(y_scale_3_all)

```



\subsection{Ninja Warrior - Part 2}



**How large would you say the difference between 'Jumping spider' and 'Salmon Ladder' is?**



```{r echo=F}
default <- def_ratio$def_1
narrower <- nar_ratio$nar_1
wider <- wid_ratio$wid_1
ratio_1_all <- cbind(default, wider, narrower)


noquote(paste('n (default) = ', length(default)))
noquote(paste('n (narrower) = ', length(narrower)))
noquote(paste('n (wider) = ', length(wider)))
noquote(rbind(summary(ratio_1_all), c(paste0('Var    :', round(var(default), 3)), paste0('Var    :', round(var(wider), 3)), paste0('Var    :', round(var(narrower), 3)))))

```


```{r echo=F}
default <- def_ratio$def_1

narrower <- nar_ratio$nar_1[which(nar_ratio$nar_1 != 3)]
narrower <- narrower[which(narrower != 4)]

wider <- wid_ratio$wid_1[which(wid_ratio$wid_1 != 2)]
wider <- wider[which(wider != 3)]

ratio_1_all <- cbind(default, wider, narrower)


noquote(paste('n (default) = ', length(default)))
noquote(paste('n (narrower) = ', length(narrower)))
noquote(paste('n (wider) = ', length(wider)))
noquote(rbind(summary(ratio_1_all), c(paste0('Var    :', round(var(default), 3)), paste0('Var    :', round(var(wider), 3)), paste0('Var    :', round(var(narrower), 3)))))

```





**How large would you say the difference between 'Log Grip' and 'Floating Steps' is?**


```{r echo=F}
default <- def_ratio$def_2
narrower <- nar_ratio$nar_2
wider <- wid_ratio$wid_2

ratio_1_all <- cbind(default, wider, narrower)


noquote(paste('n (default) = ', length(default)))
noquote(paste('n (narrower) = ', length(narrower)))
noquote(paste('n (wider) = ', length(wider)))
noquote(rbind(summary(ratio_1_all), c(paste0('Var    :', round(var(default), 3)), paste0('Var    :', round(var(wider), 3)), paste0('Var    :', round(var(narrower), 3)))))

```




**How many times would you say 'Floating Steps' were used?**

```{r echo=F}
default <- def_ratio$def_3
narrower <- nar_ratio$nar_3
wider <- wid_ratio$wid_3

ratio_1_all <- cbind(default, wider, narrower)


noquote(paste('n (default) = ', length(default)))
noquote(paste('n (narrower) = ', length(narrower)))
noquote(paste('n (wider) = ', length(wider)))
noquote(rbind(summary(ratio_1_all), c(paste0('Var    :', round(var(default), 3)), paste0('Var    :', round(var(wider), 3)), paste0('Var    :', round(var(narrower), 3)))))

```


```{r echo=F}
default <- default[-which(default >= 30)]
narrower <- narrower[-which(narrower <= 25)]

ratio_1_all <- cbind(default, wider, narrower)


noquote(paste('n (default) = ', length(default)))
noquote(paste('n (narrower) = ', length(narrower)))
noquote(paste('n (wider) = ', length(wider)))
noquote(rbind(summary(ratio_1_all), c(paste0('Var    :', round(var(default), 3)), paste0('Var    :', round(var(wider), 3)), paste0('Var    :', round(var(narrower), 3)))))

```

**Comparisons**


```{r echo=F}
comp_1 <- comp_ratio$all_1
comp_1 <- comp_1[-which(comp_1 == "none")]
comp_2 <- comp_ratio$all_2
comp_3 <- comp_ratio$all_3
tab <- rbind(table(comp_1), table(comp_2), table(comp_3))
rownames(tab) <- c("Most aesthetically pleasing?", "Easiest to read and interpret?", "Hardest to read and interpret?")
tab
```

```{r include=F}
cbind(comp_ratio$all_1, comp_ratio$all_2)

count <- 0

for(i in 1:length(comp_ratio$all_1)){
  if (comp_ratio$all_1[i] == "Default" && comp_ratio$all_2[i] == "Default"){
    count <- count + 1
  }
}

count

```


\subsection{Ninja Warrior - Part 3}


**How many times would you say 'Floating Steps' were used in the Finals (Regional/City) round?**


```{r echo=F}
vir_stacked_1 <- vir_stacked$vir_sta_1
def_stacked_1 <- def_stacked$def_sta_1
gr_stacked_1 <- gr_stacked$gr_sta_1

vir_grouped_1 <- vir_stacked$vir_grp_1
def_grouped_1 <- def_stacked$def_grp_1
gr_grouped_1 <- gr_stacked$gr_grp_1

stacked_1 <- c(vir_stacked_1, def_stacked_1, gr_stacked_1)
grouped_1 <- c(vir_grouped_1, def_grouped_1, gr_grouped_1)

bars <- data.frame(stacked_1, grouped_1)

noquote(paste('n (stacked) = ', length(stacked_1)))
noquote(paste('n (grouped) = ', length(grouped_1)))

sumy <- summary(bars)
colnames(sumy) <- c("Stacked", "Grouped")
noquote(rbind(sumy, c(paste0('Var    :', round(var(stacked_1), 2)), paste0('Var    :', round(var(grouped_1), 2)))))
```



```{r}

stacked_1 <- c(vir_stacked_1, def_stacked_1, gr_stacked_1)
grouped_1 <- c(vir_grouped_1, def_grouped_1, gr_grouped_1)

before_s <- length(stacked_1)
stacked_1 <- stacked_1[-which(stacked_1 >= 25)] 
after_s <- length(stacked_1)

before_g <- length(grouped_1)
grouped_1 <- grouped_1[-which(grouped_1 >= 20)] 
after_g <- length(grouped_1)

n.outliers_s <- before_s-after_s
n.outliers_g <- before_g-after_g

noquote(paste("Number of outliers (stacked):", n.outliers_s))
noquote(paste("Number of outliers (grouped):", n.outliers_g))

sumy <- noquote(rbind(cbind(summary(stacked_1), summary(grouped_1)), c(paste0('Var    :', round(var(stacked_1), 3)), paste0('Var    :', round(var(grouped_1), 3)))))
colnames(sumy) <- c("Stacked", "Grouped")
sumy
```


```{r}

vir_stacked_1 <- vir_stacked$vir_sta_1
def_stacked_1 <- def_stacked$def_sta_1
gr_stacked_1 <- gr_stacked$gr_sta_1

vir_grouped_1 <- vir_stacked$vir_grp_1
def_grouped_1 <- def_stacked$def_grp_1
gr_grouped_1 <- gr_stacked$gr_grp_1

stacked_1 <- c(vir_stacked_1, def_stacked_1, gr_stacked_1)
grouped_1 <- c(vir_grouped_1, def_grouped_1, gr_grouped_1)

stacked_1 <- stacked_1[which(stacked_1 >= 25)] 

summary(stacked_1)
stacked_1 <- c(vir_stacked_1, def_stacked_1, gr_stacked_1)
stacked_1 <- stacked_1[-which(stacked_1 >= 25)]
grouped_1 <- c(vir_grouped_1, def_grouped_1, gr_grouped_1) 
```

\textbf{Shapiro test for the responses for the stacked bar plot}
```{r}
shapiro.test(stacked_1)
```

\textbf{Shapiro test for the responses for the stacked bar plot}
```{r}
shapiro.test(grouped_1)
```


\textbf{Sign test for the responses for the stacked bar plot}
```{r}
SIGN.test(stacked_1, md=11, alternative="t")
```

\textbf{Sign test for the responses for the grouped bar plot}
```{r}
SIGN.test(grouped_1, md=11, alternative="t")
```

\textbf{T-test on samples from the distribution of responses for the stacked bar plot}
```{r}
means <- rep(NA, 100)
for(i in 1:100){
  samp <- rnorm(100, mean=mean(stacked_1), sd=sd(stacked_1))
  means[i] <- mean(samp)
}
t.test(means, mu=11)
```

\textbf{T-test on samples from the distribution of responses for the grouped bar plot}
```{r}
means <- rep(NA, 100)
for(i in 1:100){
  samp <- rnorm(100, mean=mean(grouped_1), sd=sd(grouped_1))
  means[i] <- mean(samp)
}
t.test(means, mu=11)

```
Running t-tests on the means, however, we see both sets of responses differ statistically significantly from the true value.

**How many times would you say 'Log Grip' was used in the Finals (Regional/City) round?**


```{r echo=F}
vir_stacked_2 <- vir_stacked$vir_sta_2
def_stacked_2 <- def_stacked$def_sta_2
gr_stacked_2 <- gr_stacked$gr_sta_2

vir_grouped_2 <- vir_stacked$vir_grp_2
def_grouped_2 <- def_stacked$def_grp_2
gr_grouped_2 <- gr_stacked$gr_grp_2

stacked_2 <- c(vir_stacked_2, def_stacked_2, gr_stacked_2)
grouped_2 <- c(vir_grouped_2, def_grouped_2, gr_grouped_2)

bars <- data.frame(stacked_2, grouped_2)

noquote(paste('n (stacked) = ', length(stacked_2)))
noquote(paste('n (grouped) = ', length(grouped_2)))

sumy <- summary(bars)
colnames(sumy) <- c("Stacked", "Grouped")
noquote(rbind(sumy, c(paste0('Var    :', round(var(stacked_2), 3)), paste0('Var    :', round(var(grouped_2), 3)))))
```


```{r}

stacked_2 <- c(vir_stacked_2, def_stacked_2, gr_stacked_2)
grouped_2 <- c(vir_grouped_2, def_grouped_2, gr_grouped_2)

before_s <- length(stacked_2)
stacked_2 <- stacked_2[-which(stacked_2 >= 20)] 
after_s <- length(stacked_2)

n.outliers_s <- before_s-after_s
n.outliers_g <- before_g-after_g

noquote(paste("Number of outliers (stacked):", n.outliers_s))
noquote(paste("Number of outliers (grouped):", n.outliers_g))

sumy <- noquote(rbind(cbind(summary(stacked_2), summary(grouped_2)), c(paste0('Var    :', round(var(stacked_2), 3)), paste0('Var    :', round(var(grouped_2), 3)))))
colnames(sumy) <- c("Stacked", "Grouped")
sumy
```


\textbf{Shapiro test for the responses for the stacked bar plot}
```{r}
shapiro.test(stacked_2)
symmetry.test(stacked_2)
```

\textbf{Shapiro test for the responses for the stacked bar plot}
```{r}
shapiro.test(grouped_2)
symmetry.test(grouped_2)
```


\textbf{Sign test for the responses for the stacked bar plot}
```{r}
SIGN.test(stacked_2, md=9, alternative="t")
```

\textbf{Sign test for the responses for the grouped bar plot}
```{r}
SIGN.test(grouped_2, md=9, alternative="t")
```


\textbf{T-test on samples from the distribution of responses for the stacked bar plot}
```{r}
means <- rep(NA, 100)
for(i in 1:100){
  samp <- rnorm(100, mean=mean(stacked_2), sd=sd(stacked_2))
  means[i] <- mean(samp)
}
t.test(means, mu=9)
```

\textbf{T-test on samples from the distribution of responses for the grouped bar plot}
```{r}
means <- rep(NA, 100)
for(i in 1:100){
  samp <- rnorm(100, mean=mean(grouped_2), sd=sd(grouped_2))
  means[i] <- mean(samp)
}
t.test(means, mu=9)

```


**Please select the statement you feel applies to the bar chart above.**

```{r echo=F}
vir_stacked_3 <- vir_stacked$vir_sta_3
def_stacked_3 <- def_stacked$def_sta_3
gr_stacked_3 <- gr_stacked$gr_sta_3

vir_grouped_3 <- vir_stacked$vir_grp_3
def_grouped_3 <- def_stacked$def_grp_3
gr_grouped_3 <- gr_stacked$gr_grp_3

stacked_3 <- c(vir_stacked_3, def_stacked_3, gr_stacked_3)
grouped_3 <- c(vir_grouped_3, def_grouped_3, gr_grouped_3)

tab <- rbind(table(stacked_3), table(grouped_3))
rownames(tab) <- c("Stacked", "Grouped")
colnames(tab) <- c("Equal", "Less", "More")
tab
```

**Which obstacle do you think was used MORE in Finals (Regional/City) rounds, 'Log Grip' or 'Floating Steps'?**

```{r echo=F}
vir_stacked_4 <- vir_stacked$vir_sta_4
def_stacked_4 <- def_stacked$def_sta_4
gr_stacked_4 <- gr_stacked$gr_sta_4

vir_grouped_4 <- vir_stacked$vir_grp_4
def_grouped_4 <- def_stacked$def_grp_4
gr_grouped_4 <- gr_stacked$gr_grp_4

stacked_4 <- c(vir_stacked_4, def_stacked_4, gr_stacked_4)
grouped_4 <- c(vir_grouped_4, def_grouped_4, gr_grouped_4)

tab <- rbind(table(stacked_4), table(grouped_4))
rownames(tab) <- c("Stacked", "Grouped")
colnames(tab) <- c("Floating Steps", "Log Grip", "Both the same")
tab
```

**Which bar chart do you feel is easiest to read and interpret?**

```{r echo=F}
a_1 <- set_a$sta_dge
b_1 <- set_b$sta_dge
c_1 <- set_c$sta_dge
d_1 <- set_d$sta_dge
e_1 <- set_e$sta_dge
f_1 <- set_f$sta_dge

for(i in 1:length(a_1)){
  if(a_1[i] == "A"){
    a_1[i] <- "Stacked"
  } else a_1[i] <- "Grouped"
}

for(i in 1:length(b_1)){
  if(b_1[i] == "A"){
    b_1[i] <- "Stacked"
  } else b_1[i] <- "Grouped"
}

for(i in 1:length(d_1)){ 
  if(d_1[i] == "A"){
    d_1[i] <- "Stacked"
  } else d_1[i] <- "Grouped"
}

for(i in 1:length(c_1)){
  if(c_1[i] == "B"){
    c_1[i] <- "Stacked"
  } else c_1[i] <- "Grouped"
}

for(i in 1:length(e_1)){
  if(e_1[i] == "B"){
    e_1[i] <- "Stacked"
  } else e_1[i] <- "Grouped"
}

for(i in 1:length(f_1)){
  if(f_1[i] == "B"){
    f_1[i] <- "Stacked"
  } else f_1[i] <- "Grouped"
}

tab <- table(c(a_1, b_1, c_1, d_1, e_1, f_1))
tab
```


``` {r, echo=F}
tab <- rbind(table(a_1), table(b_1), table(c_1), table(d_1), table(e_1), table(f_1))
rownames(tab) <- c("Set A", "Set B", "Set C", "Set D", "Set E", "Set F")
tab
```


**Which colour scheme do you find most aesthetically pleasing?**

```{r}

set <- c("A", "B", "C", "D", "E", "F")
first_col <- c("Viridis", "Default", "Default", "Greyscale", "Viridis", "Greyscale")
second_col <- c("Default", "Viridis", "Greyscale", "Default", "Greyscale", "Viridis")

df <- data.frame(set, first_col, second_col)
names(df) <- c("Pairing ID", "Main Colour Palette", "Secondary Colour Pallette")
knitr::kable(df)
```

```{r echo=F}
a_1 <- set_a$a_cols_1
b_1 <- set_b$b_cols_1
c_1 <- set_c$c_cols_1
d_1 <- set_d$d_cols_1
e_1 <- set_e$e_cols_1
f_1 <- set_f$f_cols_1

tab <- rbind(table(a_1), table(b_1), table(c_1), table(d_1), c(table(e_1), 0), table(f_1))
rownames(tab) <- c("Set A", "Set B", "Set C", "Set D", "Set E", "Set F")
tab
```

**Do you feel that one of the colour schemes makes it easier to read and interpret? If so, please select which one.**

```{r echo=F, fig.cap="Table showing which colour palettes respondents found easiest to read and interpret"}
a_1 <- set_a$a_cols_2
b_1 <- set_b$b_cols_2
c_1 <- set_c$c_cols_2
d_1 <- set_d$d_cols_2
e_1 <- set_e$e_cols_2
f_1 <- set_f$f_cols_2

for(i in 1:length(a_1)){
  if(a_1[i] == "Yes, A is easier"){
    a_1[i] <- "A"
  } else if(a_1[i] == "Yes, A is easier"){
  a_1[i] <- "B"
  } else a_1[i] <- "None"
}

for(i in 1:length(b_1)){
  if(b_1[i] == "Yes, B is easier"){
    b_1[i] <- "B"
  } else if(b_1[i] == "Yes, A is easier"){ 
    b_1[i] <- "A"
    }else b_1[i] <- "None"
}

for(i in 1:length(e_1)){
  if(e_1[i] == "Yes, A is easier"){
    e_1[i] <- "A"
  } else if(e_1[i] == "Yes, B is easier"){
    e_1[i] <- "B"
  } else e_1[i] <- "None"
}

for(i in 1:length(f_1)){
  if(f_1[i] == "Yes, B is easier"){
    f_1[i] <- "B"
  } else if(f_1[i] == "Yes, A is easier"){
    f_1[i] <- "A"
  } else f_1[i] <- "None"
}

for(i in 1:length(c_1)){
  if(c_1[i] == "Yes, A is easier"){
    c_1[i] <- "A"
  } else if(c_1[i] == "Yes, B is easier"){ 
    c_1[i] <- "B"
  } else c_1[i] <- "None"
}

for(i in 1:length(d_1)){
  if(d_1[i] == "Yes, A is easier"){
    d_1[i] <- "A"
  } else if(d_1[i] == "Yes, B is easier"){ 
    d_1[i] <- "B"
  } else d_1[i] <- "None"
}

tab <- rbind(c(table(a_1)[1], 0, table(a_1)[2]), c(table(b_1)[1], 0, table(b_1)[2]), c(table(c_1), 0), c(table(d_1), 0), c(table(e_1), 0, 0), table(f_1))
colnames(tab) <- c("A", "B", "None")
tab
```

\subsection{Sales - Part 1}
**How much would you say sales of each company increased between January and December? [Company A]**

```{r echo=F}
sep_1a <- na.exclude(ab_sep$sep_1a)
trn_1a <- ab_trn$ab_trn_1a
zro_1a <- ab_zero$ab_zro_1

for(i in 1:length(sep_1a)){
  if(sep_1a[i] == "1 (A little)"){
    sep_1a[i] <- "1"
  }
  if(sep_1a[i] == "7 (A lot)"){
    sep_1a[i] <- "7"
  }
}

for(i in 1:length(trn_1a)){
  if(trn_1a[i] == "1 (A little)"){
    trn_1a[i] <- "1"
  }
  if(trn_1a[i] == "7 (A lot)"){
    trn_1a[i] <- "7"
  }
}

for(i in 1:length(zro_1a)){
  if(zro_1a[i] == "1 (A little)"){
    zro_1a[i] <- "1"
  }
  if(zro_1a[i] == "7 (A lot)"){
    zro_1a[i] <- "7"
  }
}

sep_1a <- as.numeric(sep_1a)
trn_1a <- as.numeric(trn_1a)
zro_1a <- as.numeric(zro_1a)

sumy <- cbind(summary(sep_1a), summary(trn_1a), summary(zro_1a))
colnames(sumy) <- c("Separate", "Truncated", "Zeroed")

sumy

```


**How much would you say sales of each company increased between January and December? [Company B]**

```{r echo=F}
sep_1b <- na.exclude(ab_sep$sep_1b)
trn_1b <- na.exclude(ab_trn$ab_trn_1b)
zro_1b <- na.exclude(ab_zero$ab_zro_1b)

for(i in 1:length(sep_1b)){
  if(sep_1b[i] == "1 (A little)"){
    sep_1b[i] <- "1"
  }
  if(sep_1b[i] == "7 (A lot)"){
    sep_1b[i] <- "7"
  }
}

for(i in 1:length(trn_1b)){
  if(trn_1b[i] == "1 (A little)"){
    trn_1b[i] <- "1"
  }
  if(trn_1b[i] == "7 (A lot)"){
    trn_1b[i] <- "7"
  }
}

for(i in 1:length(zro_1b)){
  if(zro_1b[i] == "1 (A little)"){
    zro_1b[i] <- "1"
  }
  if(zro_1b[i] == "7 (A lot)"){
    zro_1b[i] <- "7"
  }
}

sep_1b <- as.numeric(sep_1b)
trn_1b <- as.numeric(trn_1b)
zro_1b <- as.numeric(zro_1b)

sumy <- cbind(summary(sep_1b), summary(trn_1b), summary(zro_1b))
colnames(sumy) <- c("Separate", "Truncated", "Zeroed")

sumy

```


**How large would you say the drop in sales between April and July of Company A  is?**

```{r echo=F}
sep_2 <- na.exclude(ab_sep$sep_2)
trn_2 <- na.exclude(ab_trn$ab_trn_2)
zro_2 <- na.exclude(ab_zero$ab_zro_2)

sumy <- cbind(summary(sep_2), summary(trn_2), summary(zro_2))
colnames(sumy) <- c("Separate", "Truncated", "Zeroed")

sumy

```

\subsection{Sales - Part 2}

**Based on the above graph, how large would you say the difference is between the number of sales Company C makes and the number of sales Company D makes?**


```{r echo=F}
trn_cd <- na.exclude(cd_trn$cd_trn)
zro_cd <- na.exclude(cd_zro$cd_zro)

sumy <- cbind(summary(trn_cd), summary(zro_cd))
colnames(sumy) <- c("Truncated", "Zeroed")

sumy

```






















